{% extends 'base.html' %}
{% block content %}
    <h1>암호화 및 복호화 실험</h1>
    <p>생성된 키를 사용하여 메시지를 암호화하고 복호화합니다.</p>

    <h2>현재 키 정보</h2>
    <p><strong>개인키 (w, p, y):</strong> {{ session.get('private_key', '키를 먼저 생성해주세요.') }}</p>
    <p><strong>공개키 (β):</strong> {{ session.get('public_key', '키를 먼저 생성해주세요.') }}</p>
    <hr>

    <h2>암호화</h2>
    <form method="post" action="{{ url_for('crypto') }}">
        <input type="hidden" name="action" value="encrypt">
        <label for="plaintext">평문 (숫자):</label><br>
        <p style="font-size: 0.9em; color: #555;">입력 가능 범위: 0 ~ {{ session.get('max_plaintext_val', '키를 먼저 생성해주세요.') }}</p>
        <input type="number" id="plaintext" name="plaintext" size="50" value="{{ session.get('plaintext', '') }}"><br><br>
        <button type="submit">암호화</button>
    </form>
    <p><strong>입력된 평문의 이진수:</strong> {{ session.get('binary_plaintext', '') }}</p>
    <p><strong>암호문:</strong> {{ session.get('ciphertext', '') }}</p>

    <hr>

    <h2>복호화</h2>
    <form method="post" action="{{ url_for('crypto') }}">
        <input type="hidden" name="action" value="decrypt">
        <label for="ciphertext_input">암호문 (숫자):</label><br>
        <input type="number" id="ciphertext_input" name="ciphertext_input" value="{{ session.get('ciphertext_input', '') }}"><br><br>
        <button type="submit">복호화</button>
    </form>
    <p><strong>복호화된 평문 (숫자):</strong> {{ session.get('decrypted_text', '') }}</p>

{% endblock %}
